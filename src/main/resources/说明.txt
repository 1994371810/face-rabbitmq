首先项目启动时查询所有的学校和设备，为每个学校创建一个Fanout类型的交换机，
然后为学校的每一个设备创建一个队列绑定到学校交换机内。
然后将学校人脸机放入redis的hash类型中key为特殊字符家学校id hk为设备id v为设备信息。

添加设备：添加设备首先存库，存库成功后为队列创建队列，绑定到对应学校的交换机内，然后再将设备信息放入redis中

批量添加人脸： 前端批量上传学生照片，后台接收到文件后根据文件名与学生对应的方式保存图片，然后插入faceManager表中
然后将任务进行拆分，比如一次导入了3000个人脸数据，得分为6次防止人脸机压力过大，然后将任务发送到rabbitMQ中对应的交换机内
因为交换机是fanout类型会将消息分发到每个设备的队列内。

心跳上报： 人脸机每30秒回调用服务器的心跳地址，将设备信息，处理信息发送上来，然后我们接送到人练机的心跳后查询设备的详细
信息后从rabbitmq中获取一条任务，然后先在人脸处理记录表内插入一条记录状态设置为0表示已发送到人脸机，然后将任务封装成人脸机规定的格式
然后返回给人脸机

人脸数据处理：人脸机在发送心跳是回携带上一次任务的处理结果，我们获取到成功的学生id和失败的学生id然后修改人脸处理表的状态为1或者-1并使
识别次数加一

人脸重新下发：查询人脸处理表内状态为-1并且处理次数小于等于5的并且处理时间大于任务发送时间的数据，
为次数为5的人脸数据，发送微信模板消息，次数不超过五的重新放入rabbitmq重新下发。

学生请假：学生家长再微信端提交请假任务插入到请假表中，班主任同意提交后调用人脸服务下发允许通行的任务。首先发送一条
允许通行的任务设置消息优先级为最高，然后发送到学校对应的交换机，由交换机发送给所有人脸设备，然后还要往tt队列内放一条
重新添加考勤策略的任务目的是理由死信队列完成通行后重新设置学生的通行策略。